<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>‡∏ñ‡∏≠‡∏î‡∏£‡∏´‡∏±‡∏™‡∏•‡πà‡∏≤‡∏û‡∏µ‡πà‡∏£‡∏´‡∏±‡∏™</title>
  <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@500&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js"></script>
  <style>
    body {
  margin: 0;
  padding: 0;
  font-family: 'Cinzel', serif;
  background: linear-gradient(145deg, #0c0f1a, #1b1f2b);
  color: #f1f5f9;
  min-height: 100vh;
  display: flex;
  flex-direction: column;
  align-items: center;
  box-sizing: border-box; /* Ensure padding/border included in width */
  overflow-x: hidden; /* Keep to prevent horizontal scroll */
}

* {
  box-sizing: border-box; /* Apply globally to all elements */
}

h1 {
  font-size: 2.5rem;
  margin: 2rem 0 0.5rem;
  color: #e0e7ff;
  text-shadow: 0 0 5px #60a5fa;
  text-align: center;
  width: 100%;
  padding: 0 1rem; /* Add padding for small screens */
}

.stage {
  background: rgba(30, 41, 59, 0.6);
  backdrop-filter: blur(6px);
  border: 2px solid #60a5fa;
  border-radius: 1rem;
  padding: 1rem; /* Reduced padding for mobile */
  margin: 1rem auto;
  width: 100%; /* Full width for mobile */
  max-width: 400px; /* Smaller max-width for mobile */
  box-shadow: 0 0 20px #60a5fa44;
  display: flex;
  flex-direction: column;
  align-items: center;
  text-align: center;
}

#seniorCluesPage {
  background: rgba(30, 41, 59, 0.6);
  backdrop-filter: blur(6px);
  border: 2px solid #60a5fa;
  border-radius: 1rem;
  padding: 1rem; /* Reduced padding */
  margin: 1rem auto;
  width: 100%; /* Full width */
  max-width: 400px; /* Smaller max-width */
  box-shadow: 0 0 20px #60a5fa44;
  display: flex;
  flex-direction: column;
  align-items: center;
  text-align: center;
  animation: flicker 3s infinite;
}

@keyframes flicker {
  0%, 100% { box-shadow: 0 0 20px #60a5fa44; }
  50% { box-shadow: 0 0 10px #ff555544; }
}

.senior-clue-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 0.8rem; /* Slightly smaller gap */
  margin-top: 1rem;
  width: 100%;
}

.senior-clue-box {
  background: #1e293b;
  border: 1px solid #60a5fa;
  border-radius: 5px;
  padding: 0.8rem; /* Reduced padding */
  color: #facc15;
  font-size: 0.9rem; /* Smaller font */
  text-align: center;
  animation: fadeIn 0.5s ease-in;
  min-height: 40px; /* Smaller height */
  display: flex;
  align-items: center;
  justify-content: center;
}

@keyframes fadeIn {
  from { opacity: 0; transform: translateY(10px); }
  to { opacity: 1; transform: translateY(0); }
}

p, code {
  max-width: 100%;
  overflow-wrap: break-word;
  word-break: break-word; /* Use break-word instead of break-all */
  white-space: normal;
  font-size: 0.9rem; /* Slightly smaller */
  padding: 0.3rem;
  overflow-x: hidden; /* Prevent horizontal scroll */
}

code {
  background: #1e293b;
  border-radius: 4px;
  display: block; /* Change to block for better wrapping */
  max-width: 100%;
  white-space: pre-wrap; /* Allow wrapping */
}

input[type="text"] {
  width: 90%; /* Slightly more width */
  padding: 0.6rem; /* Reduced padding */
  border: none;
  border-radius: 5px;
  font-size: 0.9rem; /* Smaller font */
  margin-top: 0.5rem;
  background-color: #1e293b;
  color: #f1f5f9;
  box-shadow: inset 0 0 5px #3b82f6;
}

input::placeholder {
  color: #94a3b8;
}

button {
  background-color: #3b82f6;
  color: #fff;
  padding: 0.6rem 1rem; /* Smaller padding */
  border: none;
  border-radius: 5px;
  cursor: pointer;
  margin-top: 0.5rem;
  margin-left: 0.3rem;
  transition: 0.3s;
  font-weight: bold;
  box-shadow: 0 0 10px #3b82f6aa;
}

button:hover {
  background-color: #2563eb;
  transform: scale(1.05);
}

button:disabled {
  background-color: #6b7280;
  cursor: not-allowed;
  transform: none;
  box-shadow: none;
}

.result {
  margin-top: 1rem;
  font-size: 1rem; /* Smaller font */
  color: #38bdf8;
  font-weight: bold;
}

.clue-log {
  margin-top: 0.5rem;
  font-size: 0.9rem;
  color: #facc15;
  max-width: 100%;
  overflow-wrap: break-word;
}

.stage-hidden, .page-hidden {
  display: none;
}

#hamburger {
  position: fixed;
  top: 0.8rem; /* Adjusted for mobile */
  left: 0.8rem;
  font-size: 1.8rem; /* Smaller size */
  color: #60a5fa;
  cursor: pointer;
  z-index: 1000;
  display: flex;
  align-items: center;
}

.menu-hint {
  position: absolute;
  left: 2.5rem; /* Adjusted for mobile */
  background: #1e40af;
  color: #f1f5f9;
  padding: 0.4rem 0.8rem; /* Smaller padding */
  border-radius: 5px;
  font-size: 0.8rem;
  opacity: 0;
  transform: translateY(10px);
  transition: all 0.3s ease;
  pointer-events: none;
}

#hamburger:hover .menu-hint {
  opacity: 1;
  transform: translateY(0);
}

#sideMenu {
  position: fixed;
  top: 0;
  left: 0;
  width: 200px; /* Smaller width for mobile */
  height: 100%;
  background-color: #0f172a;
  border-right: 2px solid #3b82f6;
  padding-top: 3.5rem; /* Adjusted padding */
  transition: transform 0.4s ease;
  z-index: 999;
  transform: translateX(-200px); /* Match new width */
  overflow-y: auto; /* Enable vertical scrolling */
}

#sideMenu ul {
  list-style: none;
  padding: 0;
  margin: 0;
}

#sideMenu li {
  padding: 1rem; /* Slightly smaller padding */
  border-bottom: 1px solid #334155;
  color: #f1f5f9;
  cursor: pointer;
  transition: 0.2s;
  text-align: center;
}

#sideMenu li:hover {
  background-color: #1e293b;
  color: #93c5fd;
  letter-spacing: 1px;
}

#sideMenu.show {
  transform: translateX(0);
}

.toast {
  position: fixed;
  bottom: 15px; /* Adjusted for mobile */
  left: 50%;
  transform: translateX(-50%) translateY(100px);
  background: #1e40af;
  color: #f1f5f9;
  padding: 0.8rem 1.5rem; /* Smaller padding */
  border-radius: 8px;
  box-shadow: 0 0 15px #60a5fa;
  opacity: 0;
  z-index: 1000;
  font-size: 0.9rem;
  transition: all 0.5s ease;
  max-width: 90%; /* Prevent overflow */
}

.toast.show {
  transform: translateX(-50%) translateY(0);
  opacity: 1;
}

.toast.hide {
  transform: translateX(-50%) translateY(100px);
  opacity: 0;
}

#puzzlePieces {
  margin: 0.5rem 0;
  color: #facc15;
  font-size: 0.9rem; /* Smaller font */
  text-align: center;
}

#puzzleContainer {
  display: flex;
  flex-wrap: wrap;
  gap: 0.4rem; /* Smaller gap */
  margin: 0.5rem 0;
  justify-content: center;
}

.puzzle-piece {
  background: #1e293b;
  padding: 0.4rem; /* Smaller padding */
  border-radius: 5px;
  cursor: move;
  color: #f1f5f9;
  border: 1px solid #60a5fa;
  font-size: 0.9rem;
}

#finalResult {
  margin-top: 0.5rem;
  color: #38bdf8;
  font-weight: bold;
  text-align: center;
}

#puzzleSection {
  margin: 1rem auto;
  width: 100%; /* Full width */
  max-width: 400px; /* Smaller max-width */
  text-align: center;
}

#scoreDisplay {
  margin: 0.5rem 0;
  color: #93c5fd;
  font-size: 0.9rem;
  text-align: center;
}

@media (max-width: 768px) {
  h1 {
    font-size: 1.6rem; /* Further reduced */
    margin-top: 2.5rem;
  }

  .stage, #seniorCluesPage {
    width: 100%; /* Full width */
    max-width: 100vw; /* Fit viewport */
    padding: 0.8rem; /* Smaller padding */
  }

  .senior-clue-grid {
    grid-template-columns: 1fr; /* Single column */
    gap: 0.6rem; /* Smaller gap */
  }

  p, code {
    font-size: 0.8rem; /* Smaller font */
    padding: 0.2rem;
    overflow-x: hidden; /* Prevent horizontal scroll */
  }

  input[type="text"] {
    width: 95%; /* Full width */
    font-size: 0.8rem;
  }

  button {
    padding: 0.5rem 0.8rem; /* Smaller buttons */
    margin-left: 0.2rem;
    font-size: 0.8rem;
  }

  #hamburger {
    font-size: 1.6rem; /* Smaller hamburger */
    top: 0.6rem;
    left: 0.6rem;
  }

  .menu-hint {
    font-size: 0.7rem;
    padding: 0.2rem 0.6rem;
    left: 2rem;
  }

  .toast {
    width: 95%; /* Full width */
    font-size: 0.8rem;
    padding: 0.6rem 1rem;
  }

  .puzzle-piece, .senior-clue-box {
    padding: 0.3rem;
    font-size: 0.7rem; /* Smaller font */
    min-height: 30px; /* Smaller height */
  }

  #scoreDisplay, #puzzlePieces {
    font-size: 0.8rem;
  }

  #sideMenu {
    width: 180px; /* Smaller sidebar */
    transform: translateX(-180px); /* Match new width */
  }

  #sideMenu.show {
    transform: translateX(0);
  }
}
  </style>
</head>
<body>
  <audio id="successSound" src="https://www.soundjay.com/buttons/beep-01a.mp3"></audio>
  <audio id="errorSound" src="https://www.soundjay.com/buttons/beep-02.mp3"></audio>
  <audio id="spookySound" src="https://www.soundjay.com/ambient/sounds/creepy-ambience-01.mp3"></audio>

  <div id="hamburger" onclick="toggleMenu()">‚ûî <span class="menu-hint">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏î‡πà‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà</span></div>

  <div id="sideMenu">
    <ul>
      <li onclick="setDifficulty('easy')">‡πÇ‡∏´‡∏°‡∏î: ‡∏á‡πà‡∏≤‡∏¢</li>
      <li onclick="setDifficulty('hard')">‡πÇ‡∏´‡∏°‡∏î: ‡∏¢‡∏≤‡∏Å</li>
      <li onclick="goToStage(1)">‡∏î‡πà‡∏≤‡∏ô‡∏ó‡∏µ‡πà 1 </li>
      <li onclick="goToStage(2)">‡∏î‡πà‡∏≤‡∏ô‡∏ó‡∏µ‡πà 2 </li>
      <li onclick="goToStage(3)">‡∏î‡πà‡∏≤‡∏ô‡∏ó‡∏µ‡πà 3 </li>
      <li onclick="goToStage(4)">‡∏î‡πà‡∏≤‡∏ô‡∏ó‡∏µ‡πà 4 </li>
      <li onclick="goToStage(5)">‡∏î‡πà‡∏≤‡∏ô‡∏ó‡∏µ‡πà 5 </li>
      <li onclick="goToStage(6)">‡∏î‡πà‡∏≤‡∏ô‡∏ó‡∏µ‡πà 6 </li>
      <li onclick="showSeniorCluesPage()">‡∏Ñ‡∏≥‡πÉ‡∏ö‡πâ‡∏à‡∏≤‡∏Å‡∏û‡∏µ‡πà‡∏£‡∏´‡∏±‡∏™</li>
      <li onclick="resetGame()">‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÉ‡∏´‡∏°‡πà‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</li>
    </ul>
  </div>

  <h1>üîç‡∏ñ‡∏≠‡∏î‡∏£‡∏´‡∏±‡∏™‡∏•‡πà‡∏≤‡∏û‡∏µ‡πà20</h1>
  <div id="scoreDisplay">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô: <span id="scoreValue">0</span> (‡∏û‡∏¢‡∏≤‡∏¢‡∏≤‡∏°: <span id="attemptsValue">0</span>)</div>
  <div id="puzzlePieces">‡∏ä‡∏¥‡πâ‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏à‡∏¥‡πä‡∏Å‡∏ã‡∏≠‡∏ß‡πå: <span id="piecesList">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ä‡∏¥‡πâ‡∏ô‡∏™‡πà‡∏ß‡∏ô</span></div>

  <div id="stage1" class="stage">
    <h2>‡∏î‡πà‡∏≤‡∏ô‡∏ó‡∏µ‡πà 1</h2>
    <p>‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏≤‡∏ï‡∏±‡∏î‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡πÅ‡∏¢‡πà‡πÉ‡∏ô‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï‡∏≠‡∏≠‡∏Å‡πÑ‡∏õ‡∏°‡∏±‡∏Å‡∏à‡∏∞‡πÄ‡∏à‡∏≠‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πà‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏£‡∏≤: <code> 1101011A1101111B1100100C100000D1101010E1100001F100000G1101110H1100111I1100001J1101001</code></p>
    <input type="text" id="answer1" placeholder="‡πÉ‡∏™‡πà‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì..."/>
    <button onclick="checkAnswer(1)">‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö</button>
    <button id="hint1" onclick="showHint(1)">‡∏Ç‡∏≠‡∏Ñ‡∏≥‡πÉ‡∏ö‡πâ(‡∏Ç‡∏∂‡πâ‡∏ô‡∏≠‡∏¢‡∏π‡πà‡∏Å‡∏±‡∏ö‡πÇ‡∏´‡∏°‡∏î ‡∏á‡πà‡∏≤‡∏¢/‡∏¢‡∏≤‡∏Å )</button>
    <div id="result1" class="result"></div>
    <button id="nextStageButton1" onclick="goToNextStage(1)" style="display: none;">‡πÄ‡∏•‡πà‡∏ô‡∏î‡πà‡∏≤‡∏ô‡∏ñ‡∏±‡∏î‡πÑ‡∏õ</button>
    <div id="clueLog1" class="clue-log"></div>
  </div>

  <div id="stage2" class="stage stage-hidden">
    <h2>‡∏î‡πà‡∏≤‡∏ô‡∏ó‡∏µ‡πà 2</h2>
    <p> 7 ‡∏Å‡πá‡∏î‡∏µ 7 ‡∏Å‡πá‡πÄ‡∏•‡∏ß ‡∏™‡∏•‡∏±‡∏ö‡∏Å‡∏±‡∏ô‡πÑ‡∏õ: <code>11001000101010110010101010101101011010101011011100101010110111101010101101001</code></p>
    <input type="text" id="answer2" placeholder="‡πÉ‡∏™‡πà‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì..."/>
    <button onclick="checkAnswer(2)">‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö</button>
    <button id="hint2" onclick="showHint(2)">‡∏Ç‡∏≠‡∏Ñ‡∏≥‡πÉ‡∏ö‡πâ(‡∏Ç‡∏∂‡πâ‡∏ô‡∏≠‡∏¢‡∏π‡πà‡∏Å‡∏±‡∏ö‡πÇ‡∏´‡∏°‡∏î ‡∏á‡πà‡∏≤‡∏¢/‡∏¢‡∏≤‡∏Å )</button>
    <div id="result2" class="result"></div>
    <button id="nextStageButton2" onclick="goToNextStage(2)" style="display: none;">‡πÄ‡∏•‡πà‡∏ô‡∏î‡πà‡∏≤‡∏ô‡∏ñ‡∏±‡∏î‡πÑ‡∏õ</button>
    <div id="clueLog2" class="clue-log"></div>
  </div>

  <div id="stage3" class="stage stage-hidden">
    <h2>‡∏î‡πà‡∏≤‡∏ô‡∏ó‡∏µ‡πà 3</h2>
    <p>(a √ó x + b) mod 26 , a = 5, b = 8 , A = 0, B = 1, ..., Z = 25 <code>ZEQXIWVMIW</code></p>
    <input type="text" id="answer3" placeholder="‡πÉ‡∏™‡πà‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì..."/>
    <button onclick="checkAnswer(3)">‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö</button>
    <button id="hint3" onclick="showHint(3)">‡∏Ç‡∏≠‡∏Ñ‡∏≥‡πÉ‡∏ö‡πâ(‡∏Ç‡∏∂‡πâ‡∏ô‡∏≠‡∏¢‡∏π‡πà‡∏Å‡∏±‡∏ö‡πÇ‡∏´‡∏°‡∏î ‡∏á‡πà‡∏≤‡∏¢/‡∏¢‡∏≤‡∏Å )</button>
    <div id="result3" class="result"></div>
    <button id="nextStageButton3" onclick="goToNextStage(3)" style="display: none;">‡πÄ‡∏•‡πà‡∏ô‡∏î‡πà‡∏≤‡∏ô‡∏ñ‡∏±‡∏î‡πÑ‡∏õ</button>
    <div id="clueLog3" class="clue-log"></div>
  </div>

  <div id="stage4" class="stage stage-hidden">
    <h2>‡∏î‡πà‡∏≤‡∏ô‡∏ó‡∏µ‡πà 4</h2>
    <p>‡∏ö‡∏≤‡∏á‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏ô‡∏û‡∏≠‡∏î‡∏µ‡∏Å‡πá‡∏≠‡∏≤‡∏à‡∏à‡∏∞‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÑ‡∏î‡πâ‡∏™‡∏¥‡πà‡∏á‡∏î‡∏µ‡πÜ‡∏ô‡∏∞ ‡∏à‡∏≤‡∏Å‡∏Ñ‡∏ô‡∏¢‡∏∏‡∏Ñ 90s: <code>555 444 666 66 55 444 66 4 1 0 # 999</code></p>
    <input type="text" id="answer4" placeholder="‡πÉ‡∏™‡πà‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì..."/>
    <button onclick="checkAnswer(4)">‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö</button>
    <button id="hint4" onclick="showHint(4)">‡∏Ç‡∏≠‡∏Ñ‡∏≥‡πÉ‡∏ö‡πâ(‡∏Ç‡∏∂‡πâ‡∏ô‡∏≠‡∏¢‡∏π‡πà‡∏Å‡∏±‡∏ö‡πÇ‡∏´‡∏°‡∏î ‡∏á‡πà‡∏≤‡∏¢/‡∏¢‡∏≤‡∏Å )</button>
    <div id="result4" class="result"></div>
    <button id="nextStageButton4" onclick="goToNextStage(4)" style="display: none;">‡πÄ‡∏•‡πà‡∏ô‡∏î‡πà‡∏≤‡∏ô‡∏ñ‡∏±‡∏î‡πÑ‡∏õ</button>
    <div id="clueLog4" class="clue-log"></div>
  </div>

  <div id="stage5" class="stage stage-hidden">
    <h2>‡∏î‡πà‡∏≤‡∏ô‡∏ó‡∏µ‡πà 5</h2>
    <p>‡πÇ‡∏≠‡πâ‡πÅ‡∏≠‡∏õ‡πÄ‡∏õ‡∏¥‡πâ‡∏•: <code>[1] m = 10, a = 10.3 [2] m = 3, a = 32.33 [3] m = 5, a = 21.8 [4] m = 6, a = 16.83 [5] m = 2, a = 49.5 [6] m = 7, a = 15.42 [7] m = 1, a = 101 [8] m = 5, a = 19.4 [9] m = 9, a = 12.66</code></p>
    <input type="text" id="answer5" placeholder="‡πÉ‡∏™‡πà‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì..."/>
    <button onclick="checkAnswer(5)">‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö</button>
    <button id="hint5" onclick="showHint(5)">‡∏Ç‡∏≠‡∏Ñ‡∏≥‡πÉ‡∏ö‡πâ(‡∏Ç‡∏∂‡πâ‡∏ô‡∏≠‡∏¢‡∏π‡πà‡∏Å‡∏±‡∏ö‡πÇ‡∏´‡∏°‡∏î ‡∏á‡πà‡∏≤‡∏¢/‡∏¢‡∏≤‡∏Å )</button>
    <div id="result5" class="result"></div>
    <button id="nextStageButton5" onclick="goToNextStage(5)" style="display: none;">‡πÄ‡∏•‡πà‡∏ô‡∏î‡πà‡∏≤‡∏ô‡∏ñ‡∏±‡∏î‡πÑ‡∏õ</button>
    <div id="clueLog5" class="clue-log"></div>
  </div>

  <div id="stage6" class="stage stage-hidden">
    <h2>‡∏î‡πà‡∏≤‡∏ô‡∏ó‡∏µ‡πà 6</h2>
    <p>(‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡∏û‡∏•‡∏±‡∏á‡∏á‡∏≤‡∏ô <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mo>=</mo><mn>4.30387658</mn><mo>√ó</mo><mn>1</mn><msup><mn>0</mn><mrow><mo>‚àí</mo><mn>31</mn></mrow></msup><mtext>‚Äâ</mtext><mtext>J</mtext></mrow><annotation encoding="application/x-tex"> E = 4.30387658 \times 10^{-31} \, \text{J} </annotation></semantics></math> ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏µ‡πà‡∏Ç‡∏≠‡∏á‡∏≠‡∏ô‡∏∏‡∏†‡∏≤‡∏Ñ‡πÉ‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Ñ‡∏ß‡∏≠‡∏ô‡∏ï‡∏±‡∏°‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏°‡∏ß‡∏• <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>=</mo><mn>1</mn><mtext>‚Äâ</mtext><mtext>kg</mtext></mrow><annotation encoding="application/x-tex"> m = 1 \, \text{kg} </annotation></semantics></math> ‡πÅ‡∏•‡∏∞‡πÄ‡∏•‡∏Ç‡∏Ñ‡∏ß‡∏≠‡∏ô‡∏ï‡∏±‡∏° <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex"> l = 0 </annotation></semantics></math>„ÄÇ ‡πÅ‡∏õ‡∏•‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏µ‡πà (‡πÉ‡∏ô‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡πÄ‡∏ï‡πá‡∏°‡πÇ‡∏î‡∏¢‡∏ï‡∏±‡∏î‡∏ó‡∏®‡∏ô‡∏¥‡∏¢‡∏°) ‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏ï‡∏£‡∏¥‡∏á ASCII ‡πÇ‡∏î‡∏¢‡πÉ‡∏ä‡πâ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç 9 ‡∏ï‡∏±‡∏ß‡πÅ‡∏£‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏´‡∏±‡∏™ ASCII ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£ 9 ‡∏ï‡∏±‡∏ß ‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏´‡∏±‡∏™‡∏™‡∏ï‡∏£‡∏¥‡∏á‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏õ‡πá‡∏ô Base64 ‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢‡∏Ñ‡∏∑‡∏≠‡∏™‡∏ï‡∏£‡∏¥‡∏á ASCII ‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏´‡∏±‡∏™ Base64)<code></code></p>
    <input type="text" id="answer6" placeholder="‡πÉ‡∏™‡πà‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì..."/>
    <button onclick="checkAnswer(6)">‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö</button>
    <button id="hint6" onclick="showHint(6)">‡∏Ç‡∏≠‡∏Ñ‡∏≥‡πÉ‡∏ö‡πâ(‡∏Ç‡∏∂‡πâ‡∏ô‡∏≠‡∏¢‡∏π‡πà‡∏Å‡∏±‡∏ö‡πÇ‡∏´‡∏°‡∏î ‡∏á‡πà‡∏≤‡∏¢/‡∏¢‡∏≤‡∏Å )</button>
    <div id="result6" class="result"></div>
    <button id="nextStageButton6" onclick="goToNextStage(6)" style="display: none;">‡∏à‡∏±‡∏î‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏à‡∏¥‡πä‡∏Å‡∏ã‡∏≠‡∏ß‡πå</button>
    <div id="clueLog6" class="clue-log"></div>
  </div>

  <div id="puzzleSection">
    <div id="puzzleContainer"></div>
    <button id="checkFinalButton" onclick="checkFinalAnswer()" style="display: none;">‡∏™‡∏∑‡∏ö‡∏´‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏£‡∏¥‡∏á</button>
    <div id="finalResult"></div>
  </div>

  <div id="toast" class="toast"></div>

  <script>
    const answers = {
      1: "kod ja ngai",
      2: "deknoi",
      3: "tumdaingai",
      4: "lionking",
      5: "gameclear",
      6: "000000650"
    };

    const clues = {
      1: { easy: "‡∏ï‡∏±‡∏î‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£", hard: "‡∏™‡∏ô‡πÉ‡∏à‡πÅ‡∏Ñ‡πà‡πÄ‡∏•‡∏Ç" },
      2: { easy: "14‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏≤‡πÅ‡∏Ñ‡πà7‡∏ï‡∏±‡∏ß", hard: "‡πÑ‡∏°‡πà‡πÄ‡∏≠‡∏≤0101010" },
      3: { easy: "‡∏ñ‡∏≠‡∏î‡∏£‡∏´‡∏±‡∏™ affine cipher ‡∏î‡πâ‡∏ß‡∏¢ a‚Åª¬π", hard: "‡πÉ‡∏ä‡πâ‡∏Å‡∏≤‡∏£‡∏ñ‡∏≠‡∏î‡∏£‡∏´‡∏±‡∏™ affine cipher ‡πÇ‡∏î‡∏¢‡∏´‡∏≤‡∏Ñ‡πà‡∏≤ a‚Åª¬π ‡πÅ‡∏•‡∏∞‡πÅ‡∏õ‡∏•‡∏á‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡∏Å‡∏•‡∏±‡∏ö" },
      4: { easy: "‡∏õ‡∏∏‡πà‡∏°‡∏Å‡∏î", hard: "‡∏õ‡∏∏‡πà‡∏°‡∏Å‡∏î‡πÅ‡∏•‡∏∞‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏ö‡∏ô‡∏õ‡∏∏‡πà‡∏°‡∏Å‡∏î" },
      5: { easy: "‡∏ü‡∏¥‡∏™‡∏¥‡∏Å‡∏™‡πå", hard: "‡∏ô‡∏¥‡∏ß‡∏ï‡∏±‡∏ô" },
      6: { easy: "‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö 9 ‡∏Å‡πá‡πÅ‡∏Ñ‡πà‡πÄ‡∏ï‡∏¥‡∏°0‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö", hard: "‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏•‡∏á‡∏ó‡πâ‡∏≤‡∏¢‡∏î‡πâ‡∏ß‡∏¢ 0 " }
    };

    const puzzlePieces = {
      1: "T",
      2: "RU",
      3: "TH",
      4: "IS",
      5: "FO",
      6: "UND"
    };

    const seniorClues = {
      1: "‡∏Å‡∏±‡∏ô‡∏î‡∏±‡∏°",
      2: "‡πÑ‡∏°‡πà‡πÉ‡∏™‡πà‡πÅ‡∏ß‡πà‡∏ô",
      3: "nike",
      4: "‡∏ü‡∏¥‡∏™‡∏¥‡∏Å‡∏™‡πå",
      5: "8",
      6: "‡πÄ‡∏õ‡πá‡∏ô‡∏ú‡∏π‡πâ‡∏ä‡∏≤‡∏¢"
    };

    let clueUsed = {
      1: false,
      2: false,
      3: false,
      4: false,
      5: false,
      6: false
    };

    let collectedPieces = JSON.parse(localStorage.getItem('puzzlePieces')) || [];
    let collectedSeniorClues = JSON.parse(localStorage.getItem('seniorClues')) || [];
    let score = parseInt(localStorage.getItem('score')) || 0;
    let attempts = JSON.parse(localStorage.getItem('attempts')) || {
      1: 0,
      2: 0,
      3: 0,
      4: 0,
      5: 0,
      6: 0
    };
    let difficulty = localStorage.getItem('difficulty') || 'easy';
    let sortableInstance = null;

    const successSound = document.getElementById('successSound');
    const errorSound = document.getElementById('errorSound');
    const spookySound = document.getElementById('spookySound');

    function checkAnswer(stage) {
      const input = document.getElementById(`answer${stage}`).value.trim().toLowerCase();
      const result = document.getElementById(`result${stage}`);
      const clueLog = document.getElementById(`clueLog${stage}`);
      const nextButton = document.getElementById(`nextStageButton${stage}`);
      attempts[stage]++;
      localStorage.setItem('attempts', JSON.stringify(attempts));
      updateScoreDisplay();
      if (input === answers[stage]) {
        result.innerText = 'üü¢ ‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á!';
        clueLog.innerText = `‚úîÔ∏è ‡∏î‡πà‡∏≤‡∏ô‡∏ó‡∏µ‡πà ${stage} ‡∏ú‡πà‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß`;
        nextButton.style.display = 'inline-block';
        if (stage === 6) {
          nextButton.innerText = '‡∏à‡∏±‡∏î‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏à‡∏¥‡πä‡∏Å‡∏ã‡∏≠‡∏ß‡πå';
          result.innerText += ' ‡πÑ‡∏õ‡∏à‡∏±‡∏î‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏à‡∏¥‡πä‡∏Å‡∏ã‡∏≠‡∏ß‡πå‡∏ó‡∏µ‡πà #puzzleContainer!';
        }
        if (!collectedPieces.includes(puzzlePieces[stage])) {
          collectedPieces.push(puzzlePieces[stage]);
          localStorage.setItem('puzzlePieces', JSON.stringify(collectedPieces));
          showToast(`‡∏ä‡∏¥‡πâ‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏à‡∏¥‡πä‡∏Å‡∏ã‡∏≠‡∏ß‡πå: ${puzzlePieces[stage]}`);
          if (!collectedSeniorClues.includes(seniorClues[stage])) {
            collectedSeniorClues.push(seniorClues[stage]);
            localStorage.setItem('seniorClues', JSON.stringify(collectedSeniorClues));
            showToast(`‡∏Ñ‡∏≥‡πÉ‡∏ö‡πâ‡∏à‡∏≤‡∏Å‡∏û‡∏µ‡πà‡∏£‡∏´‡∏±‡∏™: ${seniorClues[stage]}`);
          }
          confetti({
            particleCount: 100,
            spread: 70,
            origin: { y: 0.6 }
          });
          successSound.play();
          const scoreMultiplier = difficulty === 'easy' ? 0.8 : 1.2;
          score += Math.max(100 - (attempts[stage] - 1) * 10, 10) * scoreMultiplier;
          localStorage.setItem('score', score);
          updateScoreDisplay();
        }
        updatePuzzlePieces();
        updateSeniorClues();
      } else {
        result.innerText = '‚ùå ‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å ‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà!';
        nextButton.style.display = 'none';
        errorSound.play();
      }
    }

    function showHint(stage) {
      const clueLog = document.getElementById(`clueLog${stage}`);
      const hintButton = document.getElementById(`hint${stage}`);
      if (!clueUsed[stage]) {
        clueLog.innerText = `üí° ‡∏Ñ‡∏≥‡πÉ‡∏ö‡πâ: ${clues[stage][difficulty]}`;
        clueUsed[stage] = true;
        hintButton.disabled = true;
        const hintPenalty = difficulty === 'easy' ? 10 : 20;
        score = Math.max(score - hintPenalty, 0);
        localStorage.setItem('score', score);
        updateScoreDisplay();
      }
    }

    function showToast(message) {
      const toast = document.getElementById('toast');
      toast.innerText = message;
      toast.classList.add('show');
      setTimeout(() => {
        toast.classList.remove('show');
        toast.classList.add('hide');
        setTimeout(() => {
          toast.classList.remove('hide');
          toast.innerText = '';
        }, 500);
      }, 3000);
    }

    function updatePuzzlePieces() {
      const piecesList = document.getElementById('piecesList');
      const puzzleContainer = document.getElementById('puzzleContainer');
      const checkFinalButton = document.getElementById('checkFinalButton');
      piecesList.innerText = collectedPieces.join(', ') || '‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ä‡∏¥‡πâ‡∏ô‡∏™‡πà‡∏ß‡∏ô';
      puzzleContainer.innerHTML = '';
      collectedPieces.forEach(piece => {
        const div = document.createElement('div');
        div.className = 'puzzle-piece';
        div.textContent = piece;
        div.setAttribute('data-piece', piece);
        puzzleContainer.appendChild(div);
      });
      if (sortableInstance) {
        sortableInstance.destroy();
      }
      if (collectedPieces.length > 0) {
        sortableInstance = new Sortable(puzzleContainer, {
          animation: 150
        });
        checkFinalButton.style.display = 'inline-block';
      } else {
        checkFinalButton.style.display = 'none';
      }
    }

    function updateSeniorClues() {
      const seniorClueGrid = document.getElementById('seniorClueGrid');
      if (!seniorClueGrid) return;
      for (let i = 1; i <= 6; i++) {
        const clueBox = document.getElementById(`seniorClue${i}`);
        clueBox.innerText = collectedSeniorClues.includes(seniorClues[i]) ? seniorClues[i] : '????????';
      }
    }

    function checkFinalAnswer() {
      const puzzleContainer = document.getElementById('puzzleContainer');
      const pieces = Array.from(puzzleContainer.getElementsByClassName('puzzle-piece')).map(div => div.getAttribute('data-piece'));
      const finalResult = document.getElementById('finalResult');
      const correctOrder = ['T', 'RU', 'TH', 'IS', 'FO', 'UND'];
      console.log('Current pieces:', pieces);
      console.log('Correct order:', correctOrder);
      let isCorrect = pieces.length === correctOrder.length;
      for (let i = 0; i < pieces.length; i++) {
        if (pieces[i] !== correctOrder[i]) {
          isCorrect = false;
          break;
        }
      }
      if (isCorrect) {
        finalResult.innerText = 'üéâ ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏£‡∏¥‡∏á‡∏ñ‡∏π‡∏Å‡∏Ñ‡πâ‡∏ô‡∏û‡∏ö: ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏≠‡∏∞‡πÑ‡∏£‡πÄ‡∏•‡∏¢‡πÉ‡∏™‡πà‡∏°‡∏≤‡πÉ‡∏´‡πâ‡∏•‡∏∏‡πâ‡∏ô';
        confetti({
          particleCount: 200,
          spread: 100,
          origin: { y: 0.6 }
        });
        successSound.play();
        const scoreMultiplier = difficulty === 'easy' ? 0.8 : 1.2;
        score += 200 * scoreMultiplier;
        localStorage.setItem('score', score);
        updateScoreDisplay();
      } else {
        finalResult.innerText = '‚ùå ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å ‡∏•‡∏≠‡∏á‡∏à‡∏±‡∏î‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà!';
        errorSound.play();
      }
    }

    function updateScoreDisplay() {
      const scoreValue = document.getElementById('scoreValue');
      const attemptsValue = document.getElementById('attemptsValue');
      const totalAttempts = Object.values(attempts).reduce((sum, val) => sum + val, 0);
      scoreValue.innerText = Math.round(score);
      attemptsValue.innerText = totalAttempts;
    }

    function setDifficulty(mode) {
      difficulty = mode;
      localStorage.setItem('difficulty', mode);
      showToast(`‡πÇ‡∏´‡∏°‡∏î: ${mode === 'easy' ? '‡∏á‡πà‡∏≤‡∏¢' : '‡∏¢‡∏≤‡∏Å'}`);
      updateScoreDisplay();
    }

    function goToNextStage(stage) {
      if (stage < 6) {
        goToStage(stage + 1);
      } else {
        showToast('‡∏ú‡πà‡∏≤‡∏ô‡∏ó‡∏∏‡∏Å‡∏î‡πà‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß! ‡πÑ‡∏õ‡∏à‡∏±‡∏î‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏à‡∏¥‡πä‡∏Å‡∏ã‡∏≠‡∏ß‡πå‡∏ó‡∏µ‡πà #puzzleContainer');
        document.getElementById('puzzleSection').scrollIntoView({ behavior: 'smooth' });
      }
    }

    function resetGame() {
      if (confirm('‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏´‡∏£‡∏∑‡∏≠‡∏ß‡πà‡∏≤‡∏à‡∏∞‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÉ‡∏´‡∏°‡πà‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î? ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏∑‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏•‡∏ö!')) {
        // Clear localStorage
        localStorage.removeItem('puzzlePieces');
        localStorage.removeItem('score');
        localStorage.removeItem('attempts');
        localStorage.removeItem('difficulty');
        localStorage.removeItem('seniorClues');

        // Reset game state
        collectedPieces = [];
        collectedSeniorClues = [];
        score = 0;
        attempts = { 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0 };
        clueUsed = { 1: false, 2: false, 3: false, 4: false, 5: false, 6: false };
        difficulty = 'easy';

        // Reset UI
        for (let i = 1; i <= 6; i++) {
          document.getElementById(`result${i}`).innerText = '';
          document.getElementById(`clueLog${i}`).innerText = '';
          document.getElementById(`hint${i}`).disabled = false;
          document.getElementById(`answer${i}`).value = '';
          document.getElementById(`nextStageButton${i}`).style.display = 'none';
        }
        document.getElementById('finalResult').innerText = '';
        document.getElementById('puzzleContainer').innerHTML = '';
        document.getElementById('checkFinalButton').style.display = 'none';
        if (sortableInstance) {
          sortableInstance.destroy();
          sortableInstance = null;
        }
        // Remove senior clues page if exists
        const seniorCluesPage = document.getElementById('seniorCluesPage');
        if (seniorCluesPage) {
          seniorCluesPage.remove();
        }
        updatePuzzlePieces();
        updateSeniorClues();
        updateScoreDisplay();
        showToast('üéÆ ‡πÄ‡∏Å‡∏°‡∏ñ‡∏π‡∏Å‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß!');
        goToStage(1);
      }
    }

    function toggleMenu() {
      document.getElementById('sideMenu').classList.toggle('show');
    }

    function goToStage(stage) {
      for (let i = 1; i <= 6; i++) {
        document.getElementById(`stage${i}`).classList.add('stage-hidden');
        document.getElementById(`result${i}`).innerText = '';
        document.getElementById(`nextStageButton${i}`).style.display = 'none';
      }
      // Remove senior clues page if exists
      const seniorCluesPage = document.getElementById('seniorCluesPage');
      if (seniorCluesPage) {
        seniorCluesPage.remove();
      }
      document.getElementById('scoreDisplay').classList.remove('page-hidden');
      document.getElementById('puzzlePieces').classList.remove('page-hidden');
      document.getElementById('puzzleSection').classList.remove('page-hidden');
      document.getElementById(`stage${stage}`).classList.remove('stage-hidden');
      spookySound.pause();
      toggleMenu();
    }

    function showSeniorCluesPage() {
      // Remove existing senior clues page if any
      const existingPage = document.getElementById('seniorCluesPage');
      if (existingPage) {
        existingPage.remove();
      }

      // Create new senior clues page
      const seniorCluesPage = document.createElement('div');
      seniorCluesPage.id = 'seniorCluesPage';
      seniorCluesPage.innerHTML = `
        <h2>‡∏Ñ‡∏≥‡πÉ‡∏ö‡πâ‡∏à‡∏≤‡∏Å‡∏û‡∏µ‡πà‡∏£‡∏´‡∏±‡∏™</h2>
        <p>‡∏Ñ‡∏≥‡πÉ‡∏ö‡πâ‡∏à‡∏∞‡πÑ‡∏î‡πâ‡∏Å‡πá‡∏ï‡πà‡∏≠‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏≤‡∏ú‡πà‡∏≤‡∏ô‡∏î‡πà‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ñ‡∏≠‡∏î‡∏£‡∏´‡∏±‡∏™‡∏à‡∏≤‡∏Å 1 ‡πÉ‡∏ô 6 ‡∏î‡πà‡∏≤‡∏ô</p>
        <div id="seniorClueGrid" class="senior-clue-grid">
          <div class="senior-clue-box" id="seniorClue1">????????</div>
          <div class="senior-clue-box" id="seniorClue2">????????</div>
          <div class="senior-clue-box" id="seniorClue3">????????</div>
          <div class="senior-clue-box" id="seniorClue4">????????</div>
          <div class="senior-clue-box" id="seniorClue5">????????</div>
          <div class="senior-clue-box" id="seniorClue6">????????</div>
        </div>
      `;
      document.body.appendChild(seniorCluesPage);

      // Hide main game elements
      for (let i = 1; i <= 6; i++) {
        document.getElementById(`stage${i}`).classList.add('stage-hidden');
      }
      document.getElementById('scoreDisplay').classList.add('page-hidden');
      document.getElementById('puzzlePieces').classList.add('page-hidden');
      document.getElementById('puzzleSection').classList.add('page-hidden');

      // Update clues and play sound
      updateSeniorClues();
      spookySound.play();
      toggleMenu();
    }

    // Initialize on load
    updatePuzzlePieces();
    updateSeniorClues();
    updateScoreDisplay();
  </script>
</body>
</html>
